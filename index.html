<!DOCTYPE html>
<html lang="PT-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listando Repositórios do GitHub consultando API GitHub</title>
</head>
<body>
    
    <!-- Cabeçalho da tela -->
    <h1>Listando os repositórios do GitHub</h1>

    <!-- ========================================================================================================
        A <div> abaixo é composta por:    
            1) título da informação que se deseja que seja informada
            2) textbox onde o nome do usuário github deve ser informado com um id denominado: usergithubinformado
            3) botão de ação que ao ser clicado acionará a função 'getRepository',
               passando com parâmetro o nome do usuário github informado no textbox
    ======================================================================================================== -->
    <div>
        <label>Nome do usuário Github</label>
        <input type="text" id="usergithubinformado">
        <button onclick="getRepository(document.querySelector('#usergithubinformado').value)">Listar repositórios</button>
    </div>

    <!-- Somente uma linha divisória para separar a solicitação do usuário github da lista dos repositórios -->
    <hr>

    <ul>

    </ul>

    <!-- Seção de scripts (sempre no final do body) -->
    <script>

        /*
            Função que será acionada pelo botão de ação 'Listar Repositórios'
            cuja missões serão:
            1) através do nome do usuário github informado na tela, acionará a api do github para trazer a lista de repositório
            2) transformará a lista de repositórios obtida para o formato json
            3) a lista, já transformada em json será um array e cada elemento do array, que corresponderá a cada repositório
               será tratado e exibido indidualmente
        */
        function getRepository(theUserGitHub){

            // Cria uma lista desordenada e a inicializa vazia
            // Sob essa lista desordenada é que serão criadas as linha (li)
            // para exibir a informação de cada repositório
            const listaDesordenada = document.querySelector('ul')
            listaDesordenada.innerHTML = ''

            // Utiliza a API do github fornecendo o nome do usuário github e tendo como retorno os repositório que esse usuário possui no github
            fetch(`https://api.github.com/users/${theUserGitHub}/repos`)
                // ação de sucesso do fetch
                .then(async res =>{
                
                    let todosRepositorios = await res.json() // converte em json os dados dos repositórios trazidos pela API do github
                    
                    console.log(todosRepositorios.length + ' repositórios')

                    // loop para ler cada repositório e exibir as informações individualmente
                    todosRepositorios.map(cadaRepositorio => {
                        console.log(cadaRepositorio.name) // exibe o nome de cada repositóro no console.log
                        
                        // Cria o elemento li, que serão as linhas filhas do elemento ul
                        // e em cada li, serão exibidas as informações de cada repositório
                        // o elemento li deve ser criado como let para que possa ter o seu conteúdo atualizado
                        let linhaLI = document.createElement('li')
                        linhaLI.innerHTML = `${cadaRepositorio.name}`

                        // Cria um elemento hr para separar cada repositório quando esse for exibido dentro do ul
                        let separaLinha = document.createElement('hr')

                        listaDesordenada.appendChild(linhaLI)
                        listaDesordenada.appendChild(separaLinha)
                    })

                })
                
                // ação de erro do fetch
                .catch(e => {
                    console.log('erro')
                    console.log(e)
                })

        }

        
    </script> 

</body>
</html>